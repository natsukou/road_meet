(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[697],{9579:function(e,t,s){Promise.resolve().then(s.bind(s,6340))},6340:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return c}});var r=s(3827),a=s(4090),n=s(7907),l=s(8792),i=s(5790);let d=[{name:"星巴克咖啡",address:"距离中点 200米",type:"coffee",rating:4.5},{name:"喜茶",address:"距离中点 350米",type:"tea",rating:4.3},{name:"西西弗书店",address:"距离中点 500米",type:"bookstore",rating:4.7},{name:"海底捞火锅",address:"距离中点 800米",type:"restaurant",rating:4.6},{name:"城市公园",address:"距离中点 600米",type:"park",rating:4.4}];function c(){let e=(0,n.useRouter)(),t=(0,n.useParams)(),s=(0,a.useRef)(null),[c,o]=(0,a.useState)(null),[x,m]=(0,a.useState)(null),[u,h]=(0,a.useState)(!0),[f,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{let s=(0,i.PR)();if(!s){e.push("/login");return}o(s);let r=t.id,a=(0,i.yW)(r);if(!a||!a.creatorLocation||!a.partnerLocation){e.push("/task/".concat(r));return}m(a),h(!1)},[t.id,e]);let b=(null==x?void 0:x.creatorLocation)&&(null==x?void 0:x.partnerLocation)?(0,i.mZ)(x.creatorLocation,x.partnerLocation):null;return!u&&x&&b?(0,r.jsxs)("div",{className:"min-h-screen bg-light",children:[(0,r.jsx)("header",{className:"bg-white shadow-sm",children:(0,r.jsxs)("div",{className:"max-w-md mx-auto px-4 py-4 flex items-center gap-4",children:[(0,r.jsx)(l.default,{href:"/task/".concat(x.id),className:"text-gray hover:text-dark",children:"← 返回"}),(0,r.jsx)("h1",{className:"text-lg font-bold text-dark",children:"选择见面地点"})]})}),(0,r.jsxs)("div",{className:"max-w-md mx-auto",children:[(0,r.jsxs)("div",{ref:s,className:"h-64 bg-gradient-to-br from-blue-100 to-green-100 flex items-center justify-center relative overflow-hidden",children:[(0,r.jsx)("div",{className:"absolute inset-0 opacity-30",children:(0,r.jsxs)("svg",{className:"w-full h-full",viewBox:"0 0 400 300",children:[[...Array(10)].map((e,t)=>(0,r.jsx)("line",{x1:"0",y1:30*t,x2:"400",y2:30*t,stroke:"#cbd5e1",strokeWidth:"1"},"h".concat(t))),[...Array(14)].map((e,t)=>(0,r.jsx)("line",{x1:30*t,y1:"0",x2:30*t,y2:"300",stroke:"#cbd5e1",strokeWidth:"1"},"v".concat(t))),(0,r.jsx)("line",{x1:"100",y1:"0",x2:"100",y2:"300",stroke:"#94a3b8",strokeWidth:"4"}),(0,r.jsx)("line",{x1:"0",y1:"150",x2:"400",y2:"150",stroke:"#94a3b8",strokeWidth:"4"})]})}),x.creatorLocation&&(0,r.jsxs)("div",{className:"absolute",style:{left:"30%",top:"40%"},children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-primary rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg",children:"A"}),(0,r.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-primary"})]}),(0,r.jsx)("p",{className:"text-xs text-dark mt-1 bg-white px-2 py-1 rounded shadow",children:"创建者"})]}),x.partnerLocation&&(0,r.jsxs)("div",{className:"absolute",style:{left:"70%",top:"60%"},children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-8 h-8 bg-secondary rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg",children:"B"}),(0,r.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-secondary"})]}),(0,r.jsx)("p",{className:"text-xs text-dark mt-1 bg-white px-2 py-1 rounded shadow",children:"对方"})]}),(0,r.jsxs)("div",{className:"absolute",style:{left:"50%",top:"50%"},children:[(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:"w-10 h-10 bg-accent rounded-full flex items-center justify-center text-white text-xs font-bold shadow-lg animate-pulse",children:"★"}),(0,r.jsx)("div",{className:"absolute -bottom-1 left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-accent"})]}),(0,r.jsx)("p",{className:"text-xs text-dark mt-1 bg-white px-2 py-1 rounded shadow font-medium",children:"推荐中点"})]})]}),(0,r.jsx)("div",{className:"bg-white p-4 border-b",children:(0,r.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray",children:"中点坐标"}),(0,r.jsxs)("p",{className:"font-medium text-dark",children:[b.lat.toFixed(4),", ",b.lng.toFixed(4)]})]}),(0,r.jsxs)("div",{className:"text-right",children:[(0,r.jsx)("span",{className:"text-gray",children:"推荐地点"}),(0,r.jsxs)("p",{className:"font-medium text-primary",children:[d.length," 个"]})]})]})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-medium text-dark mb-3",children:"推荐见面地点"}),(0,r.jsx)("div",{className:"space-y-3",children:d.map((e,t)=>(0,r.jsx)("div",{onClick:()=>p(e),className:"bg-white p-4 rounded-xl shadow-sm cursor-pointer transition-all ".concat((null==f?void 0:f.name)===e.name?"ring-2 ring-primary":"hover:shadow-md"),children:(0,r.jsxs)("div",{className:"flex justify-between items-start",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"font-medium text-dark",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray mt-1",children:e.address}),(0,r.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,r.jsxs)("span",{className:"text-xs px-2 py-1 bg-blue-50 text-primary rounded",children:["coffee"===e.type&&"☕ 咖啡","tea"===e.type&&"\uD83E\uDDCB 茶饮","bookstore"===e.type&&"\uD83D\uDCDA 书店","restaurant"===e.type&&"\uD83C\uDF7D️ 餐厅","park"===e.type&&"\uD83C\uDF33 公园"]}),(0,r.jsxs)("span",{className:"text-xs text-accent",children:["★ ",e.rating]})]})]}),(null==f?void 0:f.name)===e.name&&(0,r.jsx)("div",{className:"w-6 h-6 bg-primary rounded-full flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-white text-xs",children:"✓"})})]})},t))}),f&&(0,r.jsxs)("button",{onClick:()=>alert("已选择 ".concat(f.name," 作为见面地点！")),className:"w-full mt-6 py-4 bg-primary text-white rounded-xl font-medium hover:bg-blue-600 transition-colors",children:["确认选择：",f.name]})]})]})]}):(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-light",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto"}),(0,r.jsx)("p",{className:"mt-4 text-gray",children:"加载中..."})]})})}},5790:function(e,t,s){"use strict";s.d(t,{Ak:function(){return n},F9:function(){return l},FZ:function(){return d},PR:function(){return a},mZ:function(){return c},yW:function(){return i}});let r={USER:"roadmeet_user",TASKS:"roadmeet_tasks"},a=()=>{let e=localStorage.getItem(r.USER);return e?JSON.parse(e):null},n=()=>{let e=localStorage.getItem(r.TASKS);return e?JSON.parse(e):[]},l=e=>{let t=n(),s=t.findIndex(t=>t.id===e.id);s>=0?t[s]=e:t.push(e),localStorage.setItem(r.TASKS,JSON.stringify(t))},i=e=>n().find(t=>t.id===e),d=()=>Math.floor(16777215*Math.random()).toString(16).toUpperCase().padStart(6,"0"),c=(e,t)=>({lat:(e.lat+t.lat)/2,lng:(e.lng+t.lng)/2})}},function(e){e.O(0,[901,971,69,744],function(){return e(e.s=9579)}),_N_E=e.O()}]);